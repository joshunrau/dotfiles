#!/usr/bin/env zsh

if [ {{ .installPackages }} = false ]; then
  echo "Package installation disabled, skipping..."
  exit 0
fi

{{- $packageManager := .packageManager }}
{{- $filter := ".[] | .{}" | replace "{}" $packageManager  }}

PACKAGE_MANAGER={{ $packageManager }}
PACKAGES=({{ .packages | jq $filter | join " " }})

if (( ! $+commands[$PACKAGE_MANAGER] )); then
  echo "ERROR: Missing expected package manager '$PACKAGE_MANAGER'"
  exit 1
fi

for pkg in $PACKAGES; do
  echo $pkg
done

